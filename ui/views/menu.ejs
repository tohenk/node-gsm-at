<% menus = {
    branding: {
        type: 'brand',
        title: apptitle,
        logo: '/images/logo.png',
        url: '/'
    },
    tasks: {
        title: 'Tasks',
        class: 'right floated',
        items: {
            about: {
                title: 'About'
            }
        }
    }
} %>
<% if(user.authenticated) {
    menus.tasks.items.logout = {
        title: 'Logout',
        url: '/logout'
    }
} %>
<% block('mainmenu', menu(menus, {mainmenu: true, indentation: 2})); %>
<% script.create('jQuery')
  .useDependencies(['jQuery/Util', 'SemanticUI/Dialog/Message'])
  .add(`
$.tasks = {
    about: function() {
        var self = this;
        var f = function() {
            var msg = $.util.template('<p>%TITLE% version %VERSION%<br/>' +
                '(c) %AUTHOR%<br/>' +
                'Licensed under %LICENSE%</p>', {
                TITLE: self.aboutInfo.title,
                VERSION: self.aboutInfo.version,
                AUTHOR: $('<div>').text(self.aboutInfo.author).html(),
                LICENSE: self.aboutInfo.license
            });
            $.ntdlg.message('task-about', 'About', msg, $.ntdlg.ICON_INFO);
        }
        if (!self.aboutInfo) {
            $.get('/about').then(function(json) {
                self.aboutInfo = json;
                f();
            });
        } else {
            f();
        }
    },
    init: function() {
        var self = this;
        $('.menu-about').on('click', function(e) {
            e.preventDefault();
            self.about();
        });
    }
}
`); %>